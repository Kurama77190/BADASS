Bgp At Doors of Autonomous Systems is
Simple
( BADASS )

Summary: This document is a subject on network administration.
Version: 2.1

Contents
I

Foreword

2

II

Introduction

3

III

General guidelines

4

IV

V

Mandatory part
IV.1
Part 1: GNS3 configuration with Docker . . . . . . . . . . . . . . . .
IV.2
Part 2: Discovering a VXLAN . . . . . . . . . . . . . . . . . . . . . .
IV.3
Part 3: Discovering BGP with EVPN . . . . . . . . . . . . . . . . . .
Submission and peer-evaluation

1

5
6
8
11
16

Chapter I
Foreword

2

Chapter II
Introduction
The purpose of this project is to expand the knowledge you have gained through NetPractice. You will have to simulate a network and configure it using GNS3 with docker images.
BGP EVPN is based on BGP (RFC 4271) and its extensions, MP-BGP (RFC 4760).
BGP is the routing protocol that drives the Internet. Through MP-BGP extensions, it
can be used to carry reachability information (NLRI) for various protocols (IPv4, IPv6, L3
VPN and in this case, EVPN). EVPN is a special family used for publishing information
about MAC addresses and the end devices that access them.

3

Chapter III
General guidelines
• The entire project must be completed in a virtual machine.
• This project involves installing and using docker as well as GNS3.
• You have to put all the configuration files of your project in folders located at
the root of your repository (see section “Submission and peer-evaluation” for more
information). The folders of the mandatory part will be named: P1, P2 and P3.

WARNING: This project involves many new concepts. Do not hesitate to
take some time to read up on how BGP and VXLANs work. Many new terms
are voluntarily used.

WARNING: This subject contains images that serve as examples and may
contain typography that does not reflect what you should render.

4

Chapter IV
Mandatory part
This project involves setting up several environments under specific rules.
It is divided into three parts you have to do in the following order:

• Part 1: GNS3 configuration with Docker.
• Part 2: Discovering a VXLAN.
• Part 3: Discovering BGP with EVPN.

You must read the entire subject to understand what you need to do.

5

Bgp At Doors of Autonomous Systems is Simple
( BADASS )

IV.1

Part 1: GNS3 configuration with Docker

For this first part, you must use and configure GNS3. It is thus necessary to install and
configure GNS3 as well as docker in your virtual machine.
Now that everything works, you need to use two docker images which you must
create.
The first image should be based on a system of your choice and must contain at least
busybox or an equivalent solution.

Alpine seems to be a good solution.

The second image should use a system of your choice and must adhere to the following
constraints:

• A software that manages packet routing (zebra or quagga).
• The service BGPD active and configured.
• The service OSPFD active and configured.
• An IS-IS routing engine service.
• busybox or an equivalent.

There are pre-built images which need to be configured with this kind
of service. Your containers must work in GNS3 with the requested
services. You can add anything you wish to complete this project.

Warning: Your images will be used throughout this project.
address should be configured by default.

6

No IP

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
You must use these two docker images in GNS3 and realize this small diagram. You
need to have both machines working. We must be able to connect to them by GNS3.

The name of the machines is not put at random it will be necessary to
have your login in the name of each equipment (here wil).

Below is an example of each image configured in GNS3:

You must render this project in a P1 folder at the root of your git repository. You
should also add the configuration files with comments to explain the set up of each equipment.

You must export this project with a ZIP compression including the
base images. This file must be visible in your git repository

7

Bgp At Doors of Autonomous Systems is Simple
( BADASS )

IV.2

Part 2: Discovering a VXLAN

You now have a functional basis to start setting up your first VXLAN (RFC 7348) network,
first in static mode and then in dynamic multicast mode. Here is the topology of your
first VXLAN:

You must configure this network using a VXLAN with an ID of 10, as shown in the
examples below. You can use any VXLAN name you like here: vxlan10. You must set up
a bridge here: br0. You can configure your ETHERNET interfaces as you wish. Below is
an example of the expected result when we inspect the traffic between our two machines
in our VXLAN.

8

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
We will now see the same thing using groups whose goal is to enable dynamic multicast.

We can notice that our machines now have a group (here 239.1.1.1 you can modify
this part):

9

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
Below is an example of how to display our mac address table in our two routers:

You must render this project in a P2 folder at the root of your git repository. You
should also add the configuration files with comments to explain the set up of each equipment.

You must export this project with a ZIP compression including the
base images. This file must be visible in your git repository.

You must use correct and consistent names for your equipment here
with the login of one of the group members.

10

Bgp At Doors of Autonomous Systems is Simple
( BADASS )

IV.3

Part 3: Discovering BGP with EVPN

Now that you have mastered the basic principles of VXLAN, we will go a little further and
explore the principles of the BGP EVPN (RFC 7432) without using MPLS to simplify the
process. The controller will learn the MAC addresses automatically. We will use our
VXLAN with ID 10, as seen in the previous part.
As in the second part we start with the topology of the expected network. We will
use the principle of route reflection (=RR). Our leaves (VTEP) will be configured to
have dynamic relationships.
This diagram represents a small data center.

For the sake of readability the names are shorter here.
have to use OSPF to simplify the evaluation.

We can see our visibility from our VTEP _wil-4 the 3 VTEPs 1.1.[1.4]

11

You will

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
We have only one route for the moment with our controller (RR):

When there is no host running we can see our VNI (10 here) as well as our preconfigured routes (type 3). No route type 2 seems to exist and it is quite normal.

12

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
A machine host_wil-1 is now functional. We can notice that without assigning an
IP address our VTEP (wil_2) automatically discovers the MAC address of the functional
machines.
We can also see the automatic creation of a route type 2:

In the same way, when we look at a second VTEP(_wil-4), we can notice the creation
of a new route type 2 generated by our RR:

13

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
We repeat the operation with a second machine (host_wil-3). We can notice the
second route set up by type 2. There is no assignment of IP address:

For our verification a simple ping allows us to see that we can access all the machines
through our RR using the VTEPs. We can see the VXLAN configured to 10 as well as our
packets ICMP. We also see packets OSPF configured:

14

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
You must render this project in a P3 folder at the root of your git repository. You
should also add the configuration files with comments to explain the set up of each equipment.

You must export this project with a ZIP compression including the
image bases. This file must be visible in your git repository.

You must use correct and consistent names for your equipment here
with the login of one of the group members.

15

Chapter V
Submission and peer-evaluation
Submit your assignment to your Git repository in the usual manner. Only the work inside
your repository will be evaluated during the defense. Do not hesitate to double-check the
names of your folders and files to ensure they are correct.
Reminder:

• Turn the mandatory part in three folders located at the root of your repository:
P1, P2 et P3.

Below is an example of the expected directory structure:
> find -maxdepth 2 -ls
424242
4 drwxr-xr-x 6 wandre wil42
4096 sept. 17 23:42 .
424242
4 drwxr-xr-x 3 wandre wil42
4096 sept. 17 23:42 ./P1
424242
4 -rw-r--r-- 1 wandre wil42
XXXX sept. 17 23:42 ./P1/P1.gns3project
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P1/_wil-1_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P1/_wil-2
424242
4 drwxr-xr-x 3 wandre wil42
4096 sept. 17 23:42 ./P2
424242
4 -rw-r--r-- 1 wandre wil42
XXXX sept. 17 23:42 ./P2/P2.gns3project
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/wil-1_g
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/_wil-1_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/_wil-1_s
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/_wil-2_g
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/_wil-2_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P2/_wil-2_s
424242
4 drwxr-xr-x 3 wandre wil42
4096 sept. 17 23:42 ./P3
424242
4 -rw-r--r-- 2 wandre wil42
4096 sept. 17 23:42 ./P3/P3.gns3project
424242
4 -rw-r--r-- 2 wandre wil42
4096 sept. 17 23:42 ./P3/_wil-1
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-1_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-2
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-2_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-3
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-3_host
424242
4 -rw-r--r-- 2 wandre wil42
XXXX sept. 17 23:42 ./P3/_wil-4
> file P3/P3.gns3project
P3/P3.gns3project: Zip archive data, at least v2.0 to extract

16

Bgp At Doors of Autonomous Systems is Simple
( BADASS )
To export your projects in zip format go to the menu file then export portable project:

During the evaluation you may have to explain the terms used in the
subject. We strongly encourage you to take the time to understand
each of these.

The evaluation process will happen on the computer of the evaluated
group.

17

